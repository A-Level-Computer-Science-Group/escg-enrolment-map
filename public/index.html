<!DOCTYPE html>
<html>
  <head>
    <title>escg-enrolment-map</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
      crossorigin=""
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <main>
      <div id="map"></div>
      <section>
        <details>
          <summary id="summary-one"><span>Gender</span></summary>
          <select onchange="setFilter('gender', this.value)" id="gender">
            <option value="none">None</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select>
        </details>
        <details>
          <summary><span>Course</span></summary>
          <select onchange="setFilter('course', this.value)" id="course">
            <option value="none">None</option>
            <option value="alevel">A-level</option>
            <option value="vocational">Vocational</option>
            <option value="appgeneral">Applied General</option>
          </select>
        </details>
        <div>
          <button
            id="button-two"
            onclick="tickToggle(this);buttonTick(this);"
            value="Eastbourne"
          >
            Eastbourne
          </button>
          <button
            id="button-three"
            onclick="tickToggle(this);buttonTick(this);"
            value="Lewes"
          >
            Lewes
          </button>
          <button
            id="button-four"
            onclick="tickToggle(this); buttonTick(this);"
            value="Hastings"
          >
            Hastings
          </button>
        </div>
      </section>
    </main>
    <script>
      const menus = document.getElementsByTagName("select");
      Object.values(menus).forEach(e => {
        e.value = "none";
      });
    </script>
    <script src="js/vendor.js"></script>
    <script src="js/main.js"></script>
    <script>
      let counter = 0;
      const greyBackground = e => {
        const x = document.querySelectorAll("button");
        x.forEach(element => {
          if (!element.classList.contains("tick")) {
            element.style.backgroundColor = "rgb(155,0,155)";
            element.style.color = "white";
            element.style.border = "rgb(155,0,155) 0.5px solid";
          } else {
            element.style.backgroundColor = "#DDDDDD";
            element.style.color = "black";
          }
          if (e) {
            element.style.backgroundColor = "rgb(155,0,155)";
            element.style.color = "white";
          }
        });
      };
      const tickToggle = element => {
        let counter = 0;
        document.querySelectorAll("button").forEach(x => {
          if (x.classList.contains("tick")) {
            x.classList.toggle("tick");
            setFilter("college", "none");
            counter += 1;
            if (counter > 1) {
              x.classList.remove("tick");
              greyBackground("none");
            }
          }
        });
        console.log(element.value);
        setFilter("college", element.value.toLowerCase());
        element.classList.toggle("tick");
        element.classList.toggle("imticked");
        greyBackground();
        counter = 0;
      };
      const buttonTick = e => {
        if (e.classList.contains("imticked")) {
          console.log(`I'm ticked`);
        } else {
          console.log(`I'm not ticked`);
          e.classList.toggle("tick");
          setFilter("college", "none");
          greyBackground();
        }
      };
    </script>
  </body>
</html>
